jQuery(document).ready((function(){let e={modalBtn:".az-modal-btn",azModal:".afro-admin-modal",cfg:damSettings,init:function(){jQuery("body").on("click","#dam-picker-button",(function(a){a.preventDefault(),e.popupWithUrl(`${e.cfg.domain}${e.cfg.searchFrag}`)})),window.addEventListener("message",(a=>{if(a.data){let t=JSON.parse(a.data);switch(t.request){case"config":e.handleConfigRequest();break;case"selected":case"selected-article":case"selected2":case"selected-article2":e.handleSelected(t);break;case"baobabCP":e.handleBaobabAuthRequest()}}}))},popupWithUrl:function(e){this.cl=window.open(e,"popupWindow","chrome=yes,titlebar=no,menubar=no,location=no,resizable=no,scrollbars=no,status=no,width=1200,height=700,centerscreen")},handleConfigRequest:function(){let a=JSON.stringify({config:e.cfg});e.cl&&/http(s)?:\/\/\w+(\-\w+)?\.(afrozaar|bibliodam|baobabsuite)\.com/.test(event.origin)&&e.cl.postMessage(a,event.origin)},handleBaobabAuthRequest:function(){let a=JSON.stringify({baobabCP:{username:e.cfg.username,password:e.cfg.password}});e.cl&&/http(s)?:\/\/\w+(\-\w+)?\.(afrozaar|bibliodam|baobabsuite)\.com/.test(event.origin)&&e.cl.postMessage(a,event.origin)},handleSelected:function(a){if(a)switch(a.request){case"selected":case"selected2":jQuery.each(a.items,(function(e,t){if("ExistingImage"===t["@type"]){let t=a.items[e].imageURL;window.parent.send_to_editor('<img class="size-large alignnone" src="'+t+'" alt="'+a.items[e].caption+'" width="150" height="150">'),window.parent.send_to_editor("<br>"),window.parent.tb_remove()}else if("Video"===a.items[e]["@type"]){let t=a.items[e].url,i=a.items[e].videoThumbnail;window.parent.send_to_editor('<img class="size-large alignnone" src="'+i+'" data-video="'+t+'" width="150" height="150">'),window.parent.send_to_editor("<br>"),window.parent.tb_remove()}}));break;case"selected-article":case"selected-article2":let t={};jQuery.each(a.items,(function(e,i){t[e]=a.items[e]})),e.showModal(a,t)}e.cl.close()},insertPost:function(a,t){let i={action:"create"};i.postData=t,jQuery.post(dcDamObject.ajax_url,{action:"ptx_admin",security:dcDamObject._nonce,data:i},(function(a){jQuery(e.azModal).find("#confirmation-wrapper").find(".load-bar").addClass("hidden"),jQuery(e.azModal).find(".confirmation-box").find(".close").fadeIn(),jQuery(e.azModal).find("#confirmation").removeClass("warning").addClass("success").html("Import has completed."),jQuery.each(a.data,(function(a,t){jQuery(e.azModal).find("#media-list ul").append("<li><span>"+("exists"===t.status?"Updated -":"Imported -")+'</span><a href="/wp-admin/post.php?post='+t.id+'&action=edit">Edit</a> - '+t.title+"</li>")}))}))},showModal:function(a,t){jQuery(e.azModal).removeClass("hidden"),jQuery("body").addClass("no-scroll"),jQuery(e.azModal).find("#confirmation").removeClass("success").addClass("warning").html("<strong>Please note:</strong><p>If you are importing an existing post, the title, content and media will be replaced with that of the inserted post. Would you like to proceed?</p>"),jQuery(e.modalBtn).on("click",(function(i){let n=jQuery(this).data("confirm");"confirm"===n?(i.preventDefault(),jQuery(e.modalBtn).fadeOut(),jQuery(e.azModal).find("#confirmation").html("Please wait while your posts are imported."),jQuery(e.azModal).find("#confirmation-wrapper").find(".load-bar").removeClass("hidden"),e.insertPost(a,t)):"cancel"===n?(i.preventDefault(),e.hideModal()):"close"===n&&(i.preventDefault(),e.hideModal(),location.reload())}))},hideModal:function(){jQuery(e.azModal).addClass("hidden").find("#confirmation").html(""),jQuery("body").removeClass("no-scroll")}};e.init(),window.damLauncher=e}));