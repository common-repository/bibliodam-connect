jQuery(document).ready((function(){let e={modalBtn:".az-modal-btn",azModal:".afro-admin-modal",cfg:damSettings,init:function(){jQuery("#dam-launcher-button").on("click",(function(t){t.preventDefault(),e.popupWithUrl(`${e.cfg.domain}${e.cfg.searchFrag}`)})),window.addEventListener("message",(t=>{if(t.data){let a=JSON.parse(t.data);switch(a.request){case"config":e.handleConfigRequest();break;case"selected":case"selected-article":case"selected2":case"selected-article2":e.handleSelected(a);break;case"baobabCP":e.handleBaobabAuthRequest()}}}))},popupWithUrl:function(e){this.cl=window.open(e,"popupWindow","chrome=yes,titlebar=no,menubar=no,location=no,resizable=no,scrollbars=no,status=no,width=1200,height=700,centerscreen")},handleConfigRequest:function(){let t=JSON.stringify({config:e.cfg});e.cl&&/http(s)?:\/\/\w+(\-\w+)?\.(afrozaar|bibliodam|baobabsuite)\.com/.test(event.origin)&&e.cl.postMessage(t,event.origin)},handleBaobabAuthRequest:function(){let t=JSON.stringify({baobabCP:{username:e.cfg.username,password:e.cfg.password}});e.cl&&/http(s)?:\/\/\w+(\-\w+)?\.(afrozaar|bibliodam|baobabsuite)\.com/.test(event.origin)&&e.cl.postMessage(t,event.origin)},handleSelected:function(t){if(t)switch(t.request){case"selected":case"selected2":jQuery.each(t.items,(function(e,a){if("ExistingImage"===a["@type"]){let a=t.items[e].imageURL;window.parent.send_to_editor('<img class="size-large alignnone" src="'+a+'" alt="'+t.items[e].caption+'" width="'+t.items[e].width+'" height="'+t.items[e].height+'">'),window.parent.tb_remove()}else if("Video"===t.items[e]["@type"]){let a=t.items[e].url;window.parent.send_to_editor('[imigino_video url="'+a+'"]'),window.parent.tb_remove()}}));break;case"selected-article":case"selected-article2":let a={};jQuery.each(t.items,(function(e,i){a[e]=t.items[e]})),e.showModal(t,a)}e.cl.close()},insertPost:function(t,a){let i={action:"create"};i.postData=a,jQuery.post(dcDamObject.ajax_url,{action:"ptx_admin",security:dcDamObject._nonce,data:i},(function(t){jQuery(e.azModal).find("#confirmation-wrapper").find(".load-bar").addClass("hidden"),jQuery(e.azModal).find(".confirmation-box").find(".close").fadeIn(),jQuery(e.azModal).find("#confirmation").removeClass("warning").addClass("success").html("Import has completed."),jQuery.each(t.data,(function(t,a){jQuery(e.azModal).find("#media-list ul").append("<li><span>"+("exists"===a.status?"Updated -":"Imported -")+'</span><a href="/wp-admin/post.php?post='+a.id+'&action=edit">Edit</a> - '+a.title+"</li>")}))}))},showModal:function(t,a){jQuery(e.azModal).removeClass("hidden"),jQuery("body").addClass("no-scroll"),jQuery(e.azModal).find("#confirmation").removeClass("success").addClass("warning").html("<strong>Please note:</strong><p>If you are importing an existing post, the title, content and media will be replaced with that of the inserted post. Would you like to proceed?</p>"),jQuery(e.modalBtn).on("click",(function(i){let n=jQuery(this).data("confirm");"confirm"===n?(i.preventDefault(),jQuery(e.modalBtn).fadeOut(),jQuery(e.azModal).find("#confirmation").html("Please wait while your posts are imported."),jQuery(e.azModal).find("#confirmation-wrapper").find(".load-bar").removeClass("hidden"),e.insertPost(t,a)):"cancel"===n?(i.preventDefault(),e.hideModal()):"close"===n&&(i.preventDefault(),e.hideModal(),location.reload())}))},hideModal:function(){jQuery(e.azModal).addClass("hidden").find("#confirmation").html(""),jQuery("body").removeClass("no-scroll")}};e.init(),window.damLauncher=e}));